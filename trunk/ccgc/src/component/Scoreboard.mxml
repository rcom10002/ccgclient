<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml"
                layout="absolute"
                width="400"
                height="209"
                verticalAlign="top"
                horizontalAlign="center"
                xmlns:model="memorphic.xpath.model.*" title="本局得分明细">
    <mx:Script>
        <![CDATA[
        	import info.knightrcom.util.ListenerBinder;
            import mx.core.Application;
            import mx.controls.Alert;
            import mx.events.CloseEvent;
            import mx.managers.PopUpManager;

            public function popUp(gameClient:DisplayObject, scoreboardInfo:Array, closeHandler:Function = null):void {
                scoreboardDataArray = new Array();
                for each (var recordDesc:String in scoreboardInfo) {
                    var recordDetailDesc:Array = recordDesc.split(/,/);
                    var record:Object = new Object();
                    record.currentNumber = recordDetailDesc[0];
                    record.score = recordDetailDesc[1];
                    record.systemScore = recordDetailDesc[2];
                    scoreboardDataArray.push(record);
                }
	            // 调整显示顺序
				scoreboardDataArray.sort(function (a:Object, b:Object):int {
	            	var valueA:int = int(a.currentNumber);
	            	var valueB:int = int(b.currentNumber);
	            	if (valueA > valueB) {
	            		return 1;
	            	} else if (valueA < valueB) {
	            		return -1;
	            	} else {
	            		return 0;
	            	}
	            });
                if (closeHandler != null) {
                	this.addEventListener(CloseEvent.CLOSE, closeHandler);
                }
                PopUpManager.addPopUp(this, gameClient, true) as Scoreboard;
                PopUpManager.centerPopUp(this);
            }
            
            private function closeHandler(event:MouseEvent):void {
                PopUpManager.removePopUp(this);
                Button(this.mx_internal::closeButton).dispatchEvent(event);
            }
        ]]>
    </mx:Script>
    <mx:creationComplete>
    	<![CDATA[
            ListenerBinder.bind(btnClose, MouseEvent.CLICK, closeHandler);
    	]]>
    </mx:creationComplete>
    <!-- 数据源与数据显示表格 -->
    <mx:Array id="scoreboardDataArray"/>
    <mx:DataGrid id="scoreboardGrid"
                 dataProvider="{scoreboardDataArray}"
                 height="125"
                 right="10"
                 left="10"
                 top="10">
        <mx:columns>
            <mx:DataGridColumn headerText="序号"
                               dataField="currentNumber"/>
            <mx:DataGridColumn headerText="得分"
                               dataField="score"/>
            <mx:DataGridColumn headerText="系统分"
                               dataField="systemScore"/>
        </mx:columns>
    </mx:DataGrid>
    <!-- 关闭按钮 -->
    <mx:Button id="btnClose"
               x="166"
               label="确定"
               top="143"/>
</mx:TitleWindow>
